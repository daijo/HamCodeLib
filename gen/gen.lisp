#! /opt/local/bin/clisp -C
;; -*- Mode: Lisp -*-

;; Copyright 2012 Daniel Hjort. All rights reserved.
;; Author: Daniel Hjort

;; Codes
(defvar *codes*
  (list '(#x2ab 0 "NUL")
'(#x2db 1 "SOH")
'(#x2ed 2 "STX")
'(#x377 3 "ETX")
'(#x2eb 4 "EOT")
'(#x35f 5 "ENQ")
'(#x2ef 6 "ACK")
'(#x2fd 7 "BEL")
'(#x2ff 8 "BS")
'(#xef 9 "HT")
'(#x1d 10 "LF")
'(#x36f 11 "VT")
'(#x2dd 12 "FF")
'(#x1f 13 "CR")
'(#x375 14 "SO")
'(#x3ab 15 "SI")
'(#x2f7 16 "DLE")
'(#x2f5 17 "DC1")
'(#x3ad 18 "DC2")
'(#x3af 19 "DC3")
'(#x35b 20 "DC4")
'(#x36b 21 "NAK")
'(#x36d 22 "SYN")
'(#x357 23 "ETB")
'(#x37b 24 "CAN")
'(#x37d 25 "EM")
'(#x3b7 26 "SUB")
'(#x355 27 "ESC")
'(#x35d 28 "FS")
'(#x3bb 29 "GS")
'(#x2fb 30 "RS")
'(#x37f 31 "US")
'(#x1 32 "SP")
'(#x1ff 33 "!")
'(#x15f 34 "\"")
'(#x1f5 35 "#")
'(#x1db 36 "$")
'(#x2d5 37 "%")
'(#x2bb 38 "&")
'(#x17f 39 "'")
'(#xfb 40 "(")
'(#xf7 41 ")")
'(#x16f 42 "*")
'(#x1df 43 "+")
'(#x75 44 ",")
'(#x35 45 "-")
'(#x57 46 ".")
'(#x1af 47 "/")
'(#xb7 48 "0")
'(#xbd 49 "1")
'(#xed 50 "2")
'(#xff 51 "3")
'(#x177 52 "4")
'(#x15b 53 "5")
'(#x16b 54 "6")
'(#x1ad 55 "7")
'(#x1ab 56 "8")
'(#x1b7 57 "9")
'(#xf5 58 ":")
'(#x1bd 59 ";")
'(#x1ed 60 "<")
'(#x55 61 "=")
'(#x1d7 62 ">")
'(#x2af 63 "?")
'(#x2bd 64 "@")
'(#x7d 65 "A")
'(#xeb 66 "B")
'(#xad 67 "C")
'(#xb5 68 "D")
'(#x77 69 "E")
'(#xdb 70 "F")
'(#xfd 71 "G")
'(#x155 72 "H")
'(#x7f 73 "I")
'(#x1fd 74 "J")
'(#x17d 75 "K")
'(#xd7 76 "L")
'(#xbb 77 "M")
'(#xdd 78 "N")
'(#xab 79 "O")
'(#xd5 80 "P")
'(#x1dd 81 "Q")
'(#xaf 82 "R")
'(#x6f 83 "S")
'(#x6d 84 "T")
'(#x157 85 "U")
'(#x1b5 86 "V")
'(#x15d 87 "W")
'(#x175 88 "X")
'(#x17b 89 "Y")
'(#x2ad 90 "Z")
'(#x1f7 91 "[")
'(#x1ef 92 "\\")
'(#x1fb 93 "]")
'(#x2bf 94 "^")
'(#x16d 95 "_")
'(#x2df 96 "`")
'(#xb 97 "a")
'(#x5f 98 "b")
'(#x2f 99 "c")
'(#x2d 100 "d")
'(#x3 101 "e")
'(#x3d 102 "f")
'(#x5b 103 "g")
'(#x2b 104 "h")
'(#xd 105 "i")
'(#x1eb 106 "j")
'(#xbf 107 "k")
'(#x1b 108 "l")
'(#x3b 109 "m")
'(#xf 110 "n")
'(#x7 111 "o")
'(#x3f 112 "p")
'(#x1bf 113 "q")
'(#x15 114 "r")
'(#x17 115 "s")
'(#x5 116 "t")
'(#x37 117 "u")
'(#x7b 118 "v")
'(#x6b 119 "w")
'(#xdf 120 "x")
'(#x5d 121 "y")
'(#x1d5 122 "z")
'(#x2b7 123 "{")
'(#x1bb 124 "|")
'(#x2b5 125 "}")
'(#x2d7 126 "~")
'(#x3b5 127 "DEL")
))


;; Generate C code

;; Ascii -> Varicode lookup array
(format t "/* Generated file */~&")
(format t "~&#include \"varicode.h\"~&")
(format t "~&#include \"varicode_data.h\"~&")
(format t "~&varicode_t codes[] = {")
(format t "~{0x~X ~^, ~}" (mapcar #'first *codes*))
(format t "};~&")

;; Varicode -> Ascii binary tree array
;; TBD

